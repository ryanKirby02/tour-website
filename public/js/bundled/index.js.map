{"mappings":"mGAAO,MAAMA,EAAS,KACpB,MAAMC,EAAUC,SAASC,cAAa,UAClCF,GAASA,EAAQG,cAAcC,YAAYJ,IAGpCK,EAAS,CAAIC,EAAMC,KAC9BR,IACA,MAAMS,EAAM,4BAA+BF,MAASC,UACpDN,SAASC,cAAa,QAASO,mBAAkB,aAAeD,GAEhEE,OAAOC,WAAWZ,EAAW,MCPlBa,EAAcC,MAAUC,EAAMR,SAQjB,mBANDS,EAAAC,GAAMC,MAAK,kBAExB,SAAJX,EAAe,iBAAmB,mBAEpCQ,IAESA,KAAKI,SACdb,EAAS,UAAU,sCACnBc,SAASC,QAEZ,MAAQC,GACPhB,EAAS,QAAUgB,EAAMC,SAASR,KAAKP,WCPrCgB,EAAStB,SAASuB,eAAc,OAChCC,EAAYxB,SAASC,cAAa,eAClCwB,EAAazB,SAASC,cAAa,gBACnCyB,EAAY1B,SAASC,cAAa,oBAClC0B,EAAqB3B,SAASC,cAAa,mBAC3C2B,EAAqB5B,SAASC,cAAa,uBAC3C4B,EAAoB7B,SAASC,cAAa,uBAC1C6B,EAAqB9B,SAASC,cAAa,wBAC3C8B,EAAU/B,SAASuB,eAAc,aAKvC,GAAID,EAAQ,CCtBW,CAAIU,IACzBC,SAASC,YAAW,iGAEpB,IAAIC,EAAM,IAAIF,SAASG,IAAG,CACxBC,UAAS,MACTC,MAAK,wDACLC,YAAY,IAGd,MAAMC,EAAS,IAAIP,SAASQ,aAE5BT,EAAUU,SAASxB,IACjB,MAAMnB,EAAUC,SAAS2C,cAAa,OACtC5C,EAAQ6C,UAAS,SAEjB,IAAIX,SAASY,OAAM,CACjB9C,QAASA,EACT+C,OAAM,WAELC,UAAU7B,EAAS8B,aACnBC,MAAMd,GAET,IAAIF,SAASiB,MAAK,CAChBC,OAAQ,KAEPJ,UAAU7B,EAAS8B,aACnBI,QAAO,UAAWlC,EAASmC,QAAQnC,EAASoC,mBAC5CL,MAAMd,GAETK,EAAOe,OAAOrC,EAAS8B,gBAGzBb,EAAIqB,UAAUhB,EAAM,CAClBiB,QAAO,CACLC,IAAK,IACLC,OAAQ,IACRC,KAAM,IACNC,MAAO,QDbXC,CADkBC,KAAKC,MAAM1C,EAAO2C,QAAQjC,YAI1CR,GACFA,EAAU0C,iBAAgB,UAAYC,IACpCA,EAAMC,iBE1BQxD,OAAUyD,EAAOC,SAMT,mBAJDxD,EAAAC,GAAMwD,KAAI,sBAAsB,OACnDF,WACAC,KAESzD,KAAKI,SACdb,EAAS,UAAU,0BACnBK,OAAOC,YAAU,KACfQ,SAASsD,OAAM,OACd,MAEN,MAAQpD,GACPhB,EAAS,QAAUgB,EAAMC,SAASR,KAAKP,WFgBvCmE,CAFczE,SAASuB,eAAc,SAAUmD,MAC9B1E,SAASuB,eAAc,YAAamD,UAKrDjD,GACFA,EAAWyC,iBAAgB,UAAYS,IACrCA,EAAEP,iBGnCaxD,OAAUgE,EAAMP,EAAOC,EAAUO,SAQ1B,mBAND/D,EAAAC,GAAMwD,KAAI,uBAAuB,MACpDK,QACAP,WACAC,kBACAO,KAEShE,KAAKI,SACdb,EAAS,UAAU,yCACnBK,OAAOC,YAAU,KACfQ,SAASsD,OAAM,cACd,MAEN,MAAQpD,GACPhB,EAAS,QAAUgB,EAAMC,SAASR,KAAKP,WHyBvCwE,CAJa9E,SAASuB,eAAc,QAASmD,MAC/B1E,SAASuB,eAAc,SAAUmD,MAC9B1E,SAASuB,eAAc,YAAamD,MAC7B1E,SAASuB,eAAc,mBAAoBmD,UAKnE/C,GACFA,EAAmBuC,iBAAgB,UAAYS,IAC7CA,EAAEP,iBACF,MAAMW,EAAO,IAAIC,SAEjBD,EAAKE,OAAM,OAASjF,SAASuB,eAAc,QAASmD,OACpDK,EAAKE,OAAM,QAAUjF,SAASuB,eAAc,SAAUmD,OACtDK,EAAKE,OAAM,QAAUjF,SAASuB,eAAc,SAAU2D,MAAM,IAE5DvE,EAAeoE,EAAI,WAInBnD,GACFA,EAAmBsC,iBAAgB,UAAStD,MAAS+D,IACnDA,EAAEP,iBAEFpE,SAASC,cAAa,uBAAwBkF,YAAW,cAEzD,MAAMb,EAAWtE,SAASuB,eAAc,oBAAqBmD,MACvDU,EAAcpF,SAASuB,eAAc,YAAamD,MAClDW,EAAqBrF,SAASuB,eAAc,oBAAqBmD,YAEjE/D,EAAc,UAAG2D,cAAUc,qBAAaC,eAE9CrF,SAASC,cAAa,uBAAwBkF,YAAW,gBAEzDnF,SAASuB,eAAc,oBAAqBmD,MAAK,GACjD1E,SAASuB,eAAc,YAAamD,MAAK,GACzC1E,SAASuB,eAAc,oBAAqBmD,MAAK,MAIjD7C,GACFA,EAAkBqC,iBAAgB,UAAStD,MAAS+D,IAClDA,EAAEP,iBAEF,MAAME,EAAWtE,SAASuB,eAAc,YAAamD,MAC/CG,EAAkB7E,SAASuB,eAAc,mBAAoBmD,MAC7DY,EAAQtF,SAASC,cAAa,kBAAmBgE,QAAQqB,WInFrC1E,OAAU0D,EAAUO,EAAiBS,SAOzC,mBALDxE,EAAAC,GAAMC,MAAK,gCAAiCsE,IAAK,UACpEhB,kBACAO,KAGShE,KAAKI,SACdb,EAAS,UAAU,qCAEnBK,OAAOC,YAAU,KACfQ,SAASsD,OAAM,YACd,OAEN,MAAQpD,GACPhB,EAAS,QAAUgB,EAAMC,SAASR,KAAKP,WJsEjCiF,CAAkBjB,EAAUO,EAAiBS,MAInDxD,GACFA,EAAmBoC,iBAAgB,UAAStD,MAAS+D,IACnDA,EAAEP,iBAEF,MAAMC,EAAQrE,SAASuB,eAAc,SAAUmD,WI1ErB9D,OAAUyD,QAKd,mBAHDvD,EAAAC,GAAMwD,KAAI,gCAA+B,OAC5DF,KAESxD,KAAKI,SACdb,EAAS,UAAU,iCAAmCiE,KAEtD5D,OAAOC,YAAU,KACfQ,SAASsD,OAAM,YACd,MAEN,MAAQpD,GACPhB,EAAS,QAAUgB,EAAMC,SAASR,KAAKP,WJ+DjCkF,CAAkBnB,MAIxB3C,GACFA,EAAUwC,iBAAgB,SEnFTtD,cAGI,mBADDE,EAAAC,GAAM0E,IAAG,yBACnB5E,KAAKI,eACLC,SAASC,QAAO,GACtBD,SAASsD,OAAM,MAElB,MAAQpD,GACPhB,EAAS,QAAQ,6DF8EjB2B,GACFA,EAAQmC,iBAAgB,SAAWS,IACjCA,EAAEe,OAAOP,YAAW,gBACpB,MAAKQ,OAAGA,GAAWhB,EAAEe,OAAOzB,QK1GXrD,OAAUgF,IAC7B,MAAMC,EAASC,OAAM,mHAKnB,MAAMC,QAAgBjF,EAAAC,GAAM0E,IAAG,qCACQG,WAGjCC,EAAOG,mBAAkB,CAC7BC,UAAWF,EAAQlF,KAAKkF,QAAQG,KAEnC,MAAQ9E,GACP+E,QAAQC,IAAIhF,GACZhB,EAAS,QAAUgB,KL4FnBiF,CAASV","sources":["public/js/alerts.js","public/js/updateSettings.js","public/js/index.js","public/js/mapbox.js","public/js/login.js","public/js/signup.js","public/js/resetPassword.js","public/js/stripe.js"],"sourcesContent":["export const hideAlert = () => {\r\n  const element = document.querySelector('.alert');\r\n  if (element) element.parentElement.removeChild(element);\r\n};\r\n\r\nexport const showAlert = (type, message) => {\r\n  hideAlert();\r\n  const markup = `<div class='alert alert--${type}'>${message}</div>`;\r\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\r\n\r\n  window.setTimeout(hideAlert, 5000);\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const updateSettings = async (data, type) => {\r\n  try {\r\n    const result = await axios.patch(\r\n      `/api/v1/users/${\r\n        type === 'data' ? 'update-profile' : 'update-password'\r\n      }`,\r\n      data\r\n    );\r\n    if (result.data.status === 'success') {\r\n      showAlert('success', 'Successfully updated your settings');\r\n      location.reload;\r\n    }\r\n  } catch (error) {\r\n    showAlert('error', error.response.data.message);\r\n  }\r\n};\r\n","import { login, logout } from './login';\r\nimport { displayMap } from './mapbox';\r\nimport { updateSettings } from './updateSettings';\r\nimport '@babel/polyfill';\r\nimport { signup } from './signup';\r\nimport { resetUserPassword, sendPasswordReset } from './resetPassword';\r\nimport { bookTour } from './stripe';\r\n\r\n//DOM EMEMENTS\r\nconst mapBox = document.getElementById('map');\r\nconst loginForm = document.querySelector('.form-login');\r\nconst signupForm = document.querySelector('.form-signup');\r\nconst logoutBtn = document.querySelector('.nav__el--logout');\r\nconst updateFormSettings = document.querySelector('.form-user-data');\r\nconst updatePasswordForm = document.querySelector('.form-user-settings');\r\nconst passwordResetForm = document.querySelector('.form-passwordReset');\r\nconst forgotPasswordForm = document.querySelector('.form-forgotPassword');\r\nconst bookBtn = document.getElementById('book-tour');\r\n\r\n//VALUES\r\n\r\n//DELEGATION\r\nif (mapBox) {\r\n  const locations = JSON.parse(mapBox.dataset.locations);\r\n  displayMap(locations);\r\n}\r\n\r\nif (loginForm) {\r\n  loginForm.addEventListener('submit', (event) => {\r\n    event.preventDefault();\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    login(email, password);\r\n  });\r\n}\r\n\r\nif (signupForm) {\r\n  signupForm.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const name = document.getElementById('name').value;\r\n    const email = document.getElementById('email').value;\r\n    const password = document.getElementById('password').value;\r\n    const confirmPassword = document.getElementById('confirmPassword').value;\r\n    signup(name, email, password, confirmPassword);\r\n  });\r\n}\r\n\r\nif (updateFormSettings) {\r\n  updateFormSettings.addEventListener('submit', (e) => {\r\n    e.preventDefault();\r\n    const form = new FormData();\r\n\r\n    form.append('name', document.getElementById('name').value);\r\n    form.append('email', document.getElementById('email').value);\r\n    form.append('photo', document.getElementById('photo').files[0]);\r\n\r\n    updateSettings(form, 'data');\r\n  });\r\n}\r\n\r\nif (updatePasswordForm) {\r\n  updatePasswordForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n\r\n    document.querySelector('.btn--save-password').textContent = 'updating...';\r\n\r\n    const password = document.getElementById('password-current').value;\r\n    const newPassword = document.getElementById('password').value;\r\n    const confirmNewPassword = document.getElementById('password-confirm').value;\r\n\r\n    await updateSettings({ password, newPassword, confirmNewPassword }, 'password');\r\n\r\n    document.querySelector('.btn--save-password').textContent = 'save password';\r\n\r\n    document.getElementById('password-current').value = '';\r\n    document.getElementById('password').value = '';\r\n    document.getElementById('password-confirm').value = '';\r\n  });\r\n}\r\n\r\nif (passwordResetForm) {\r\n  passwordResetForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n\r\n    const password = document.getElementById('password').value;\r\n    const confirmPassword = document.getElementById('confirmPassword').value;\r\n    const token = document.querySelector('.btn--new-pass').dataset.token;\r\n\r\n    await resetUserPassword(password, confirmPassword, token);\r\n  });\r\n}\r\n\r\nif (forgotPasswordForm) {\r\n  forgotPasswordForm.addEventListener('submit', async (e) => {\r\n    e.preventDefault();\r\n\r\n    const email = document.getElementById('email').value;\r\n\r\n    await sendPasswordReset(email);\r\n  });\r\n}\r\n\r\nif (logoutBtn) {\r\n  logoutBtn.addEventListener('click', logout);\r\n}\r\n\r\nif (bookBtn) {\r\n  bookBtn.addEventListener('click', (e) => {\r\n    e.target.textContent = 'Processing...';\r\n    const { tourid } = e.target.dataset;\r\n    bookTour(tourid);\r\n  });\r\n}\r\n","export const displayMap = (locations) => {\r\n  mapboxgl.accessToken =\r\n    'pk.eyJ1IjoicnlhbmtpcmJ5MDIiLCJhIjoiY2t1YTBnMHEzMGNicTMxbno0MGx3eWg3aCJ9.PNmOCXRNPqwpImD-UwKUJg';\r\n  var map = new mapboxgl.Map({\r\n    container: 'map',\r\n    style: 'mapbox://styles/ryankirby02/ckua0wiwh63vw17qoahtf98uh',\r\n    scrollZoom: false,\r\n  });\r\n\r\n  const bounds = new mapboxgl.LngLatBounds();\r\n\r\n  locations.forEach((location) => {\r\n    const element = document.createElement('div');\r\n    element.className = 'marker';\r\n\r\n    new mapboxgl.Marker({\r\n      element: element,\r\n      anchor: 'bottom',\r\n    })\r\n      .setLngLat(location.coordinates)\r\n      .addTo(map);\r\n\r\n    new mapboxgl.Popup({\r\n      offset: 35,\r\n    })\r\n      .setLngLat(location.coordinates)\r\n      .setHTML(`<p>Day ${location.day}: ${location.description}</p>`)\r\n      .addTo(map);\r\n\r\n    bounds.extend(location.coordinates);\r\n  });\r\n\r\n  map.fitBounds(bounds, {\r\n    padding: {\r\n      top: 200,\r\n      bottom: 150,\r\n      left: 100,\r\n      right: 100,\r\n    },\r\n  });\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const login = async (email, password) => {\r\n  try {\r\n    const result = await axios.post('/api/v1/users/login', {\r\n      email,\r\n      password,\r\n    });\r\n    if (result.data.status === 'success') {\r\n      showAlert('success', 'Logged In Successfully');\r\n      window.setTimeout(() => {\r\n        location.assign('/');\r\n      }, 1000);\r\n    }\r\n  } catch (error) {\r\n    showAlert('error', error.response.data.message);\r\n  }\r\n};\r\n\r\nexport const logout = async () => {\r\n  try {\r\n    const res = await axios.get('/api/v1/users/logout');\r\n    if (res.data.status === 'success') {\r\n      await location.reload(true);\r\n      location.assign('/');\r\n    }\r\n  } catch (error) {\r\n    showAlert('error', 'There was an error logging you out, please try again.');\r\n  }\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const signup = async (name, email, password, confirmPassword) => {\r\n  try {\r\n    const result = await axios.post('/api/v1/users/signup', {\r\n      name,\r\n      email,\r\n      password,\r\n      confirmPassword,\r\n    });\r\n    if (result.data.status === 'success') {\r\n      showAlert('success', 'Successfully Signed up for an account');\r\n      window.setTimeout(() => {\r\n        location.assign('/profile');\r\n      }, 1000);\r\n    }\r\n  } catch (error) {\r\n    showAlert('error', error.response.data.message);\r\n  }\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const resetUserPassword = async (password, confirmPassword, token) => {\r\n  try {\r\n    const result = await axios.patch(`/api/v1/users/reset-password/${token}`, {\r\n      password,\r\n      confirmPassword,\r\n    });\r\n\r\n    if (result.data.status === 'success') {\r\n      showAlert('success', 'Successfully reset your password.');\r\n\r\n      window.setTimeout(() => {\r\n        location.assign('/login');\r\n      }, 1500);\r\n    }\r\n  } catch (error) {\r\n    showAlert('error', error.response.data.message);\r\n  }\r\n};\r\n\r\nexport const sendPasswordReset = async (email) => {\r\n  try {\r\n    const result = await axios.post(`/api/v1/users/forgot-password`, {\r\n      email,\r\n    });\r\n    if (result.data.status === 'success') {\r\n      showAlert('success', `an email sent to the inbox of ${email}`);\r\n\r\n      window.setTimeout(() => {\r\n        location.assign('/login');\r\n      }, 3000);\r\n    }\r\n  } catch (error) {\r\n    showAlert('error', error.response.data.message);\r\n  }\r\n};\r\n","import axios from 'axios';\r\nimport { showAlert } from './alerts';\r\n\r\nexport const bookTour = async (tourId) => {\r\n  const stripe = Stripe(\r\n    'pk_test_51JjmkoJVSMg0D2wqDBM1E21I5KwVT0OWvtrBLO04Oc65RJCzqRVZl46IG89p1CquVa3cCdC03lzr9yWeBfK5zLjf00e3Po0BWS'\r\n  );\r\n\r\n  try {\r\n    const session = await axios.get(\r\n      `/api/v1/bookings/checkout-session/${tourId}`\r\n    );\r\n\r\n    await stripe.redirectToCheckout({\r\n      sessionId: session.data.session.id,\r\n    });\r\n  } catch (error) {\r\n    console.log(error);\r\n    showAlert('error', error);\r\n  }\r\n};\r\n"],"names":["$b01db4da9d111652$export$5a81baf3e1f8b5bb","element","document","querySelector","parentElement","removeChild","$b01db4da9d111652$export$e2ed28791945543d","type","message","markup","insertAdjacentHTML","window","setTimeout","$baec1ded6f001e5d$export$81acc09c7bdb4525","async","data","$parcel$interopDefault","$ct7a6$axios","patch","status","location","reload","error","response","$e90d12d35cb48c24$var$mapBox","getElementById","$e90d12d35cb48c24$var$loginForm","$e90d12d35cb48c24$var$signupForm","$e90d12d35cb48c24$var$logoutBtn","$e90d12d35cb48c24$var$updateFormSettings","$e90d12d35cb48c24$var$updatePasswordForm","$e90d12d35cb48c24$var$passwordResetForm","$e90d12d35cb48c24$var$forgotPasswordForm","$e90d12d35cb48c24$var$bookBtn","locations","mapboxgl","accessToken","map","Map","container","style","scrollZoom","bounds","LngLatBounds","forEach","createElement","className","Marker","anchor","setLngLat","coordinates","addTo","Popup","offset","setHTML","day","description","extend","fitBounds","padding","top","bottom","left","right","$1c25fba746cc31ee$export$976c4dce80bbf3f7","JSON","parse","dataset","addEventListener","event","preventDefault","email","password","post","assign","$212ec473d5bf09c9$export$4a142f624dd0fa8","value","e","name","confirmPassword","$f01e96e1ae20b14e$export$2f97a53cb9467bd1","form","FormData","append","files","textContent","newPassword","confirmNewPassword","token","$a98c8dd2743120ad$export$ebc2e8a44f6c7ea4","$a98c8dd2743120ad$export$d1d97352474d712c","get","target","tourid","tourId","stripe","Stripe","session","redirectToCheckout","sessionId","id","console","log","$5b30c8a71ad7f90c$export$54ca10ceadf03905"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}